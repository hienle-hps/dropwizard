apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: "war"

apply plugin: 'com.google.cloud.tools.appengine'

sourceCompatibility = 1.8

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.google.cloud.tools:appengine-gradle-plugin:1.3.4'
    }
}

ext {
    dropwizardVersion = '0.9.1'
}

repositories {
    mavenCentral()
}

dependencies {
    compile (
    	"io.dropwizard:dropwizard-core:0.9.1",
		"io.dropwizard:dropwizard-db:0.9.1",
		"io.dropwizard:dropwizard-assets:0.9.1",
		"be.fluid-it.tools.dropwizard:wizard-in-a-box:0.9-3-7"
    )

    testCompile (
        "junit:junit:4.11"
    )
}

configurations {
	compile.exclude group: "org.slf4j", module: "jul-to-slf4j"
}

task run(type: JavaExec) {
    classpath += sourceSets.main.runtimeClasspath
    main = 'com.example.helloworld.HelloWorldApplication'
    args = ['server', 'example.yml']
}

war {
    webInf {
//	from ('assets') {into 'assets'}
    }
}

appengine {
	run {
		port = 18080
		jvmFlags = ['-Xdebug', '-Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=11002']
	}

	deploy {
		stopPreviousVersion = true
		promote = true
	}
}
